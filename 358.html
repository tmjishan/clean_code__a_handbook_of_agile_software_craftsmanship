<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p358" style="overflow: hidden; position: relative; background-color: white; width: 790px; height: 1018px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_358{left:648px;bottom:945px;letter-spacing:0.14px;}
#t2_358{left:120px;bottom:945px;letter-spacing:-0.04px;word-spacing:-0.58px;}
#t3_358{left:201px;bottom:891px;letter-spacing:-0.15px;}
#t4_358{left:227px;bottom:877px;letter-spacing:-0.15px;}
#t5_358{left:227px;bottom:864px;letter-spacing:-0.15px;}
#t6_358{left:227px;bottom:850px;letter-spacing:-0.15px;}
#t7_358{left:201px;bottom:836px;}
#t8_358{left:174px;bottom:822px;letter-spacing:-0.15px;}
#t9_358{left:174px;bottom:795px;letter-spacing:-0.15px;}
#ta_358{left:174px;bottom:781px;letter-spacing:-0.15px;}
#tb_358{left:174px;bottom:767px;letter-spacing:-0.15px;}
#tc_358{left:148px;bottom:754px;}
#td_358{left:120px;bottom:729px;letter-spacing:0.09px;word-spacing:-0.22px;}
#te_358{left:414px;bottom:730px;letter-spacing:-0.15px;}
#tf_358{left:523px;bottom:729px;letter-spacing:0.12px;word-spacing:-0.49px;}
#tg_358{left:120px;bottom:711px;letter-spacing:0.11px;word-spacing:1.83px;}
#th_358{left:399px;bottom:711px;letter-spacing:-0.15px;}
#ti_358{left:478px;bottom:711px;letter-spacing:0.09px;word-spacing:1.98px;}
#tj_358{left:120px;bottom:692px;letter-spacing:0.12px;}
#tk_358{left:120px;bottom:652px;letter-spacing:0.13px;word-spacing:0.02px;}
#tl_358{left:120px;bottom:622px;letter-spacing:0.25px;word-spacing:1.38px;}
#tm_358{left:120px;bottom:604px;letter-spacing:0.1px;word-spacing:0.32px;}
#tn_358{left:120px;bottom:585px;letter-spacing:0.08px;word-spacing:0.03px;}
#to_358{left:148px;bottom:560px;letter-spacing:-0.15px;}
#tp_358{left:174px;bottom:546px;letter-spacing:-0.15px;}
#tq_358{left:174px;bottom:532px;letter-spacing:-0.15px;}
#tr_358{left:174px;bottom:518px;letter-spacing:-0.15px;}
#ts_358{left:148px;bottom:505px;}
#tt_358{left:148px;bottom:480px;letter-spacing:0.1px;word-spacing:7.18px;}
#tu_358{left:581px;bottom:481px;letter-spacing:-0.15px;}
#tv_358{left:667px;bottom:480px;}
#tw_358{left:120px;bottom:462px;letter-spacing:-0.15px;}
#tx_358{left:206px;bottom:462px;letter-spacing:0.1px;word-spacing:1.76px;}
#ty_358{left:243px;bottom:462px;letter-spacing:-0.15px;}
#tz_358{left:347px;bottom:462px;letter-spacing:0.06px;word-spacing:1.76px;}
#t10_358{left:120px;bottom:443px;letter-spacing:0.07px;word-spacing:0.04px;}
#t11_358{left:148px;bottom:418px;letter-spacing:-0.15px;}
#t12_358{left:174px;bottom:404px;letter-spacing:-0.15px;}
#t13_358{left:174px;bottom:376px;letter-spacing:-0.15px;}
#t14_358{left:201px;bottom:363px;letter-spacing:-0.15px;}
#t15_358{left:174px;bottom:349px;}
#t16_358{left:174px;bottom:335px;letter-spacing:-0.15px;}
#t17_358{left:201px;bottom:321px;letter-spacing:-0.15px;}
#t18_358{left:174px;bottom:308px;}
#t19_358{left:148px;bottom:294px;}
#t1a_358{left:120px;bottom:269px;letter-spacing:0.11px;word-spacing:5.55px;}
#t1b_358{left:120px;bottom:252px;letter-spacing:-0.15px;}
#t1c_358{left:237px;bottom:251px;letter-spacing:0.08px;word-spacing:0.34px;}
#t1d_358{left:120px;bottom:233px;letter-spacing:0.08px;word-spacing:-0.17px;}
#t1e_358{left:120px;bottom:214px;letter-spacing:0.06px;word-spacing:0.05px;}
#t1f_358{left:148px;bottom:191px;letter-spacing:0.08px;word-spacing:0.34px;}
#t1g_358{left:614px;bottom:191px;letter-spacing:0.05px;}
#t1h_358{left:120px;bottom:173px;letter-spacing:0.11px;word-spacing:0.74px;}
#t1i_358{left:223px;bottom:173px;letter-spacing:0.1px;word-spacing:0.65px;}
#t1j_358{left:120px;bottom:155px;letter-spacing:0.1px;word-spacing:0.01px;}

.s1_358{font-size:15px;font-family:TimesNewRomanPS_12k;color:#2D2D2D;}
.s2_358{font-size:15px;font-family:TimesNewRomanPS-Bold_12g;color:#2D2D2D;}
.s3_358{font-size:14px;font-family:Courier_12t;color:#2D2D2D;}
.s4_358{font-size:18px;font-family:TimesNewRomanPS-Bold_12g;color:#2D2D2D;}
.s5_358{font-size:15px;font-family:TimesNewRomanPS-Italic_12p;color:#2D2D2D;}
.t.v0_358{transform:scaleX(0.8);}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts358" type="text/css" >

@font-face {
	font-family: Courier_12t;
	src: url("fonts/Courier_12t.woff") format("woff");
}

@font-face {
	font-family: TimesNewRomanPS-Bold_12g;
	src: url("fonts/TimesNewRomanPS-Bold_12g.woff") format("woff");
}

@font-face {
	font-family: TimesNewRomanPS-Italic_12p;
	src: url("fonts/TimesNewRomanPS-Italic_12p.woff") format("woff");
}

@font-face {
	font-family: TimesNewRomanPS_12k;
	src: url("fonts/TimesNewRomanPS_12k.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg358Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg358" style="-webkit-user-select: none;"><svg id="pdf358" width="790" height="1018" viewBox="0 0 790 1018" style="width:790px; height:1018px; -moz-transform:scale(1); z-index: 0; isolation: isolate;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<defs>
<clipPath id="c0_358"><path d="M-1.6,1017.1V-.1H792.5V1017.1Z"/></clipPath>
<style type="text/css"><![CDATA[
.g0_358{
fill: none;
stroke: #FFF;
stroke-width: 1.145;
stroke-miterlimit: 10;
}
.g1_358{
fill: none;
stroke: #222;
stroke-width: 0.381;
stroke-miterlimit: 10;
}
]]></style>
</defs>
<g clip-path="url(#c0_358)">
<path d="M-58.2,1.4h55m-55,1017.5h55m797.4,0h55M794.2,1.4h55M10.4,-67.2v55m770,-55v55m0,1044.9v55m-770,-55v55" class="g0_358"/>
<path d="M-58.2,1.4h55m-55,1017.5h55m797.4,0h55M794.2,1.4h55M10.4,-67.2v55m770,-55v55m0,1044.9v55m-770,-55v55M-7.8,510.2c0,-5.1,-4.1,-9.2,-9.2,-9.2c-5,0,-9.1,4.1,-9.1,9.2c0,5,4.1,9.1,9.1,9.1c5.1,0,9.2,-4.1,9.2,-9.1Zm-36.7,0H-3.2M-17,473.5v73.3M817,510.2c0,-5.1,-4.1,-9.2,-9.2,-9.2c-5,0,-9.1,4.1,-9.1,9.2c0,5,4.1,9.1,9.1,9.1c5.1,0,9.2,-4.1,9.2,-9.1Zm-22.8,0h41.2M807.9,473.5v73.3M-7.8,19.8c0,-5.1,-4.1,-9.2,-9.2,-9.2c-5,0,-9.1,4.1,-9.1,9.2c0,5,4.1,9.1,9.1,9.1c5.1,0,9.2,-4.1,9.2,-9.1Zm-36.7,0H-3.2M-17,6V56.4m9.2,944.2c0,-5.1,-4.1,-9.2,-9.2,-9.2c-5,0,-9.1,4.1,-9.1,9.2c0,5.1,4.1,9.2,9.1,9.2c5.1,0,9.2,-4.1,9.2,-9.2Zm-36.7,0H-3.2M-17,963.9v50.4M817,19.8c0,-5.1,-4.1,-9.2,-9.2,-9.2c-5,0,-9.1,4.1,-9.1,9.2c0,5,4.1,9.1,9.1,9.1c5.1,0,9.2,-4.1,9.2,-9.1Zm-22.8,0h41.2M807.9,6V56.4m9.1,944.2c0,-5.1,-4.1,-9.2,-9.2,-9.2c-5,0,-9.1,4.1,-9.1,9.2c0,5.1,4.1,9.2,9.1,9.2c5.1,0,9.2,-4.1,9.2,-9.2Zm-22.8,0h41.2M807.9,963.9v50.4" class="g1_358"/>
</g>
</svg></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_358" class="t s1_358">327 </span><span id="t2_358" class="t s2_358">Knowing Your Library </span>
<span id="t3_358" class="t v0_358 s3_358">public String call() throws Exception { </span>
<span id="t4_358" class="t v0_358 s3_358">String result = ""; </span>
<span id="t5_358" class="t v0_358 s3_358">// make external request </span>
<span id="t6_358" class="t v0_358 s3_358">return result; </span>
<span id="t7_358" class="t v0_358 s3_358">} </span>
<span id="t8_358" class="t v0_358 s3_358">}; </span>
<span id="t9_358" class="t v0_358 s3_358">Future&lt;String&gt; result = executorService.submit(makeExternalCall); </span>
<span id="ta_358" class="t v0_358 s3_358">String partialResult = doSomeLocalProcessing(); </span>
<span id="tb_358" class="t v0_358 s3_358">return result.get() + partialResult; </span>
<span id="tc_358" class="t v0_358 s3_358">} </span>
<span id="td_358" class="t s1_358">In this example, the method starts executing the </span><span id="te_358" class="t v0_358 s3_358">makeExternalCall </span><span id="tf_358" class="t s1_358">object. The method con- </span>
<span id="tg_358" class="t s1_358" data-mappings='[[29,"fi"]]'>tinues other processing. The Ô¨Ånal line calls </span><span id="th_358" class="t v0_358 s3_358">result.get()</span><span id="ti_358" class="t s1_358">, which blocks until the future </span>
<span id="tj_358" class="t s1_358">completes. </span>
<span id="tk_358" class="t s4_358">Nonblocking Solutions </span>
<span id="tl_358" class="t s1_358">The Java 5 VM takes advantage of modern processor design, which supports reliable, </span>
<span id="tm_358" class="t s1_358">nonblocking updates. Consider, for example, a class that uses synchronization (and there- </span>
<span id="tn_358" class="t s1_358">fore blocking) to provide a thread-safe update of a value: </span>
<span id="to_358" class="t v0_358 s3_358">public class ObjectWithValue { </span>
<span id="tp_358" class="t v0_358 s3_358">private int value; </span>
<span id="tq_358" class="t v0_358 s3_358">public void synchronized incrementValue() { ++value; } </span>
<span id="tr_358" class="t v0_358 s3_358">public int getValue() { return value; } </span>
<span id="ts_358" class="t v0_358 s3_358">} </span>
<span id="tt_358" class="t s1_358">Java 5 has a series of new classes for situations like this: </span><span id="tu_358" class="t v0_358 s3_358">AtomicBoolean</span><span id="tv_358" class="t s1_358">, </span>
<span id="tw_358" class="t v0_358 s3_358">AtomicInteger</span><span id="tx_358" class="t s1_358">, and </span><span id="ty_358" class="t v0_358 s3_358">AtomicReference </span><span id="tz_358" class="t s1_358">are three examples; there are several more. We can </span>
<span id="t10_358" class="t s1_358">rewrite the above code to use a nonblocking approach as follows: </span>
<span id="t11_358" class="t v0_358 s3_358">public class ObjectWithValue { </span>
<span id="t12_358" class="t v0_358 s3_358">private AtomicInteger value = new AtomicInteger(0); </span>
<span id="t13_358" class="t v0_358 s3_358">public void incrementValue() { </span>
<span id="t14_358" class="t v0_358 s3_358">value.incrementAndGet(); </span>
<span id="t15_358" class="t v0_358 s3_358">} </span>
<span id="t16_358" class="t v0_358 s3_358">public int getValue() { </span>
<span id="t17_358" class="t v0_358 s3_358">return value.get(); </span>
<span id="t18_358" class="t v0_358 s3_358">} </span>
<span id="t19_358" class="t v0_358 s3_358">} </span>
<span id="t1a_358" class="t s1_358">Even though this uses an object instead of a primitive and sends messages like </span>
<span id="t1b_358" class="t v0_358 s3_358">incrementAndGet() </span><span id="t1c_358" class="t s1_358">instead of ++, the performance of this class will nearly always beat the </span>
<span id="t1d_358" class="t s1_358">previous version. In some cases it will only be slightly faster, but the cases where it will be </span>
<span id="t1e_358" class="t s1_358">slower are virtually nonexistent. </span>
<span id="t1f_358" class="t s1_358">How is this possible? Modern processors have an operation typically called </span><span id="t1g_358" class="t s5_358">Compare </span>
<span id="t1h_358" class="t s5_358">and Swap (CAS)</span><span id="t1i_358" class="t s1_358">. This operation is analogous to optimistic locking in databases, whereas </span>
<span id="t1j_358" class="t s1_358">the synchronized version is analogous to pessimistic locking. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
